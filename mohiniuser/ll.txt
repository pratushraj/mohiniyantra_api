< !DOCTYPE html >
    <html lang="en">

        <head>
            <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Dhankeshri Play - Loose Coupons</title>
                    <link rel="stylesheet" href="style.css">
                    </head>

                    <body>
                        <div class="top-bar">
                            <div class="top-info">
                                <span>Welcome : 2101400016</span>
                                <span>Balance Point : 97885.30</span>
                            </div>
                            <div class="top-info" style="text-align: right;">
                                <span>Date : 28:01:2026</span><br>
                                    <span>Gift Event Code : 09:45</span><br>
                                        <span>Countdown : 00:13:18</span>
                                    </div>
                                    <button class="lobby-btn" onclick="location.href='index.html'">LOBBY [Q]</button>
                            </div>

                            <div class="container fade-in">
                                <div class="menu-tabs">
                                    <button class="tab tab-bulk-a" onclick="location.href='bulk-coupons.html'">Bulk Coupons [ A ]</button>
                                    <button class="tab tab-bulk-b" onclick="location.href='bulk-coupons-b.html'">Bulk Coupons [ B ]</button>
                                    <button class="tab tab-pointwise">Pointwise Coupons</button>
                                    <button class="tab tab-loose active" onclick="location.href='loose-coupons.html'">Loose Coupons</button>
                                    <button class="tab tab-loose-pointwise">Loose Pointwise Coupons</button>
                                </div>

                                <!-- Header for Loose Coupons -->
                                <div style="display: flex; background: #eee8aa; border: 1px solid #999; margin-top: 0;">
                                    <div style="flex: 1; border-right: 1px solid #999; text-align: center; padding: 5px; font-weight: bold;">
                                        NV78 | 09:30</div>
                                    <div style="flex: 1; border-right: 1px solid #999; text-align: center; padding: 5px; font-weight: bold;">
                                        RR48 | 09:30</div>
                                    <div style="flex: 1; border-right: 1px solid #999; text-align: center; padding: 5px; font-weight: bold;">
                                        RY38 | 09:30</div>
                                    <div style="flex: 1; text-align: center; padding: 5px; font-weight: bold;">CH93 | 09:30</div>
                                </div>
                                <div style="display: flex; background: #fff; border: 1px solid #999; border-top: none;">
                                    <div class="sub-tab active" onclick="switchSubTab(this)">NV</div>
                                    <div class="sub-tab" onclick="switchSubTab(this)">RR</div>
                                    <div class="sub-tab" onclick="switchSubTab(this)">RY</div>
                                    <div class="sub-tab" onclick="switchSubTab(this)">CH</div>
                                </div>

                                <script>
                                    let currentTab = 'NV';
                                    const tabState = {
                                        'NV': { },
                                    'RR': { },
                                    'RY': { },
                                    'CH': { }
            };

                                    function switchSubTab(element) {
                // Save current tab values
                const inputs = document.querySelectorAll('.grid-input');
                                    const data = { };
                inputs.forEach((input, index) => {
                    if (input.value) data[index] = input.value;
                });
                                    tabState[currentTab] = data;

                // Update UI
                document.querySelectorAll('.sub-tab').forEach(tab => tab.classList.remove('active'));
                                    element.classList.add('active');
                                    currentTab = element.textContent.trim();

                                    // Load new tab values
                                    const newData = tabState[currentTab] || { };
                inputs.forEach((input, index) => {
                                        input.value = newData[index] || '';
                });

                                    updateTotals();
            }
                                </script>

                                <div class="loose-grid-container">
                                    <div class="loose-grid" id="numberGrid">
                                        <!-- Grid will be populated by restore logic -->
                                    </div>
                                </div>

                                <div class="bottom-actions">
                                    <button class="action-btn btn-green">UPCOMMING [F1]</button>
                                    <button class="action-btn btn-green">SUBMIT [F2]</button>
                                    <button class="action-btn btn-red" onclick="clearAll()">CLEAR [F3]</button>
                                    <button class="action-btn btn-dark-red">CANCEL [F4]</button>
                                    <button class="action-btn btn-dark-red">YANTRA [F5]</button>
                                    <button class="action-btn btn-dark-red" onclick="location.href='report.html'">C. DETAILS [F6]</button>
                                    <button class="action-btn btn-dark-red" onclick="location.href='summary.html'">P. SUM [F7]</button>
                                </div>
                            </div>

                            <script>
                                const grid = document.getElementById('numberGrid');
                                const POINT_RATE = 1.10;

                                const rows = [
                                ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', 'A0'],
                                ['10', '11', '12', '13', '14', '15', '16', '17', '18', '19', 'A1'],
                                ['20', '21', '22', '23', '24', '25', '26', '27', '28', '29', 'A2'],
                                ['30', '31', '32', '33', '34', '35', '36', '37', '38', '39', 'A3'],
                                ['40', '41', '42', '43', '44', '45', '46', '47', '48', '49', 'A4'],
                                ['50', '51', '52', '53', '54', '55', '56', '57', '58', '59', 'A5'],
                                ['60', '61', '62', '63', '64', '65', '66', '67', '68', '69', 'A6'],
                                ['70', '71', '72', '73', '74', '75', '76', '77', '78', '79', 'A7'],
                                ['80', '81', '82', '83', '84', '85', '86', '87', '88', '89', 'A8'],
                                ['90', '91', '92', '93', '94', '95', '96', '97', '98', '99', 'A9'],
                                ['B0', 'B1', 'B2', 'B3', 'B4', 'B5', 'B6', 'B7', 'B8', 'B9', 'Qty. 0'],
                                ['C0', 'C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'Pts 0.00']
                                ];

                                grid.innerHTML = '';
                                grid.style.gridTemplateColumns = 'repeat(11, 1fr)';

        rows.forEach((row, rowIndex) => {
                                    row.forEach((val, colIndex) => {
                                        // Check if it's the Summary text (Qty or Pts)
                                        if (val.startsWith('Qty.') || val.startsWith('Pts')) {
                                            const textDiv = document.createElement('div');
                                            textDiv.id = val.startsWith('Qty') ? 'qtyDisplay' : 'ptsDisplay';
                                            textDiv.textContent = val;
                                            textDiv.style.display = 'flex';
                                            textDiv.style.alignItems = 'center';
                                            textDiv.style.justifyContent = 'center';
                                            textDiv.style.fontWeight = 'bold';
                                            textDiv.style.fontSize = '18px';
                                            grid.appendChild(textDiv);
                                            return;
                                        }

                                        const input = document.createElement('input');
                                        input.className = 'grid-input';
                                        input.style.border = '1px solid #ccc';
                                        input.style.height = '34px';
                                        input.style.width = '55%';
                                        input.style.margin = '0px auto';
                                        input.type = 'text';
                                        input.placeholder = val;

                                        // Identify type of input
                                        if (rowIndex < 10 && colIndex < 10) {
                                            input.classList.add('number-input');
                                            input.setAttribute('data-row', rowIndex);
                                            input.setAttribute('data-col', colIndex);
                                        } else if (rowIndex < 10 && colIndex === 10) {
                                            input.classList.add('fill-column');
                                            input.setAttribute('data-target-index', rowIndex);
                                        } else if (rowIndex === 10 && colIndex < 10) {
                                            input.classList.add('fill-row');
                                            input.setAttribute('data-target-index', colIndex);
                                        } else if (rowIndex === 11 && colIndex < 10) {
                                            input.classList.add('fill-digit-sum');
                                            input.setAttribute('data-target-index', colIndex);
                                        }

                                        if (val === '00') {
                                            input.style.backgroundColor = '#00ff00';
                                        }

                                        input.addEventListener('input', (e) => {
                                            e.target.value = e.target.value.replace(/[^0-9]/g, '');

                                            if (input.classList.contains('fill-column')) {
                                                // A-boxes (at end of each row) fill Rows
                                                const targetRow = parseInt(input.getAttribute('data-target-index'));
                                                document.querySelectorAll(`.number-input[data-row="${targetRow}"]`).forEach(ni => ni.value = e.target.value);
                                            } else if (input.classList.contains('fill-row')) {
                                                // B-boxes (at bottom of columns) fill Columns
                                                const targetCol = parseInt(input.getAttribute('data-target-index'));
                                                document.querySelectorAll(`.number-input[data-col="${targetCol}"]`).forEach(ni => ni.value = e.target.value);
                                            } else if (input.classList.contains('fill-digit-sum')) {
                                                // C-boxes fill fields where (tens + units) ends in target
                                                const targetDigit = parseInt(input.getAttribute('data-target-index'));
                                                document.querySelectorAll('.number-input').forEach(ni => {
                                                    const tens = parseInt(ni.getAttribute('data-row'));
                                                    const units = parseInt(ni.getAttribute('data-col'));
                                                    if ((tens + units) % 10 === targetDigit) {
                                                        ni.value = e.target.value;
                                                    }
                                                });
                                            }

                                            updateTotals();
                                        });

                                        grid.appendChild(input);
                                    });
        });

                                function updateTotals() {
                                    let totalQty = 0;
            document.querySelectorAll('.number-input').forEach(input => {
                                    totalQty += (parseInt(input.value) || 0);
            });
                                const points = (totalQty * POINT_RATE).toFixed(2);
                                document.getElementById('qtyDisplay').textContent = `Qty. ${totalQty}`;
                                document.getElementById('ptsDisplay').textContent = `Pts ${points}`;
        }

                                function clearAll() {
                                    document.querySelectorAll('.grid-input').forEach(input => input.value = '');
                                updateTotals();
        }
                            </script>
                    </body>

                </html>